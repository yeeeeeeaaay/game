<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ö–∞–ø–∏–±–∞—Ä–∞ –∏ —à–æ–∫–æ–ª–∞–¥–∫–∞</title>
<style>
body {margin:0; font-family:'Comic Sans MS', Arial, sans-serif; background:#87ceeb; overflow:hidden; text-align:center;}
#questionScreen, #gameScreen {width:100vw; height:100vh; position:absolute; top:0; left:0;}
.hidden {display:none;}
#capy {position:absolute; width:150px; height:150px; background-image:url("https://png.pngtree.com/png-clipart/20240709/original/pngtree-cartoon-capybara-with-blue-suit-vector-png-image_15523170.png"); background-size:contain; background-repeat:no-repeat; top:60%; left:50%; transform:translate(-50%,-50%);}
#snickers {position:absolute; width:100px; height:40px; background-image:url("https://snickersni.kz/i/packs/dushnila.png"); background-size:contain; background-repeat:no-repeat; top:100px; left:300px;}
.cloud {position:absolute; width:305px; height:187px; background-size:contain; background-repeat:no-repeat; background-image:url("https://img.freepik.com/free-vector/realistic-white-vector-cloud-png-mockup-isolated-black-transparent-sky-background-smoky-air-cloud_90220-3160.jpg?semt=ais_hybrid&w=740&q=80"); top:0; left:0;}
#bubblesCanvas {position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999;}
iframe {position:absolute; top:10px; left:50%; transform:translateX(-50%); width:320px; height:180px; border:none; border-radius:12px;}
input {font-size:18px; padding:8px; border-radius:10px; border:2px solid #333;}
button {font-size:16px; padding:8px 16px; border-radius:8px; cursor:pointer;}
</style>
</head>
<body>

<div id="questionScreen">
  <h2>–¢–≤–æ—è –ª—é–±–∏–º–∫–∞?</h2>
  <div id="capy"></div>
  <br>
  <input id="answerInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç">
  <button onclick="checkAnswer()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
  <p id="responseText"></p>
</div>

<div id="gameScreen" class="hidden">
  <div id="capy"></div>
  <div id="snickers"></div>
  <canvas id="bubblesCanvas"></canvas>
</div>

<!-- –ú—É–∑—ã–∫–∞ -->
<iframe src="https://www.youtube.com/embed/kbEC-AGr9n0?start=13&autoplay=1&controls=0&rel=0&modestbranding=1&iv_load_policy=3&playsinline=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>

<script>
const questionScreen = document.getElementById("questionScreen");
const gameScreen = document.getElementById("gameScreen");
const capyQuestion = document.querySelectorAll("#capy")[0]; // –∫–∞–ø–∏–±–∞—Ä–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å–µ
const capyGame = document.querySelectorAll("#capy")[1]; // –∫–∞–ø–∏–±–∞—Ä–∞ –≤ –∏–≥—Ä–µ
const snickers = document.getElementById("snickers");
const responseText = document.getElementById("responseText");
const answerInput = document.getElementById("answerInput");
const bubblesCanvas = document.getElementById("bubblesCanvas");
const ctx = bubblesCanvas.getContext("2d");
bubblesCanvas.width = window.innerWidth;
bubblesCanvas.height = window.innerHeight;

// –û–±–ª–∞—á–∫–∞
const clouds = [];
for(let i=0;i<3;i++){
  const cloud = document.createElement("div");
  cloud.className="cloud";
  cloud.style.top = (50+i*100)+"px";
  cloud.style.left = Math.random()*window.innerWidth+"px";
  document.body.appendChild(cloud);
  clouds.push(cloud);
}

// –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞–ø–∏–±–∞—Ä—ã
let posX = window.innerWidth/2-75;
let posY = window.innerHeight*0.6-75;
let keys = {ArrowUp:false, ArrowDown:false, ArrowLeft:false, ArrowRight:false};

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
function checkAnswer(){
  const ans = answerInput.value.trim().toLowerCase();
  if(ans==="–ª–∏—Å–∞"){
    responseText.innerText="Chill üòé";
    setTimeout(startGame,1000);
  } else {
    responseText.innerText="–î—É–º–∞—é —Ç–≤–æ—è –ª—é–±–∏–º–∫–∞ —Ç–µ–±—è –Ω–µ –ø—Ä–æ—Å—Ç–∏—Ç üòÜ";
  }
}

// –°–æ–±—ã—Ç–∏—è –∫–ª–∞–≤–∏—à
document.addEventListener("keydown",(e)=>{if(keys.hasOwnProperty(e.key)) keys[e.key]=true;});
document.addEventListener("keyup",(e)=>{if(keys.hasOwnProperty(e.key)) keys[e.key]=false;});

// –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
function startGame(){
  questionScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");
  posX = window.innerWidth/2-75;
  posY = window.innerHeight-200;
  capyGame.style.left = posX+"px";
  capyGame.style.top = posY+"px";
  moveCapy();
  moveClouds();
}

// –î–≤–∏–∂–µ–Ω–∏–µ –∫–∞–ø–∏–±–∞—Ä—ã
function moveCapy(){
  const speed = 6;
  if(keys.ArrowUp) posY -= speed;
  if(keys.ArrowDown) posY += speed;
  if(keys.ArrowLeft) posX -= speed;
  if(keys.ArrowRight) posX += speed;

  // –ì—Ä–∞–Ω–∏—Ü—ã
  if(posX<0) posX=0;
  if(posY<0) posY=0;
  if(posX>window.innerWidth-150) posX=window.innerWidth-150;
  if(posY>window.innerHeight-150) posY=window.innerHeight-150;

  capyGame.style.left = posX+"px";
  capyGame.style.top = posY+"px";

  // –ö–∞–ø–∏–±–∞—Ä–∞ —Å—ä–µ–ª–∞ Snickers
  const capyRect = capyGame.getBoundingClientRect();
  const snickRect = snickers.getBoundingClientRect();
  if(!(capyRect.right<snickRect.left || capyRect.left>snickRect.right || capyRect.bottom<snickRect.top || capyRect.top>snickRect.bottom)){
    win();
    return;
  }

  requestAnimationFrame(moveCapy);
}

// –î–≤–∏–∂–µ–Ω–∏–µ –æ–±–ª–∞–∫–æ–≤
function moveClouds(){
  clouds.forEach(c=>{
    let left = parseFloat(c.style.left);
    left -= 0.3; // —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±–ª–∞–∫–æ–≤
    if(left<-300) left = window.innerWidth;
    c.style.left = left+"px";
  });
  requestAnimationFrame(moveClouds);
}

// –ü–æ–±–µ–¥–∞
function win(){
  alert("–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –ö–∞–ø–∏–±–∞—Ä–∞ –¥–æ—Å—Ç–∞–ª–∞ Snickers! üéâ");
  createBubbles(300);
  capyGame.style.display="none";
  snickers.style.display="none";
}

// –ü—É–∑—ã—Ä—å–∫–∏
function createBubbles(count){
  let bubbles=[];
  for(let i=0;i<count;i++){
    bubbles.push({x:Math.random()*window.innerWidth, y:Math.random()*window.innerHeight, radius:Math.random()*10+5, speed:Math.random()*2+1, opacity:Math.random()*0.5+0.5});
  }
  function draw(){
    ctx.clearRect(0,0,window.innerWidth, window.innerHeight);
    bubbles.forEach(b=>{
      ctx.beginPath();
      ctx.arc(b.x,b.y,b.radius,0,Math.PI*2);
      ctx.fillStyle=`rgba(173,216,230,${b.opacity})`;
      ctx.fill();
      b.y -= b.speed;
      if(b.y+b.radius<0) b.y=window.innerHeight+b.radius;
    });
    requestAnimationFrame(draw);
  }
  draw();
}
</script>
</body>
</html>
