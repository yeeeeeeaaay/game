<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö–∞–ø–∏–±–∞—Ä–∞ –≤ —à–∞—à–∫–∞—Ö</title>
<style>
  body {
    margin: 0;
    font-family: Comic Sans MS, Arial, sans-serif;
    background: linear-gradient(135deg,#fff7e6 0%,#ffd966 100%);
    text-align: center;
  }
  h2 {color:#6b4f4f;}
  #board {
    display: grid;
    grid-template-columns: repeat(8, 60px);
    grid-template-rows: repeat(8, 60px);
    margin: 20px auto;
    border:5px solid #6b4f4f;
  }
  .cell {
    width:60px; height:60px;
    display:flex;
    justify-content:center;
    align-items:center;
  }
  .white { background:#eee; }
  .black { background:#6b4f4f; cursor:pointer; }
  .piece {
    width:50px; height:50px;
    border-radius:50%;
  }
  .player { background:white; }
  .bot { background:black; }
  #capybara { width:150px; margin: 20px auto; }
</style>
</head>
<body>

<h2>–ò–≥—Ä–∞ –≤ —à–∞—à–∫–∏ —Å –∫–∞–ø–∏–±–∞—Ä–æ–π!</h2>
<img id="capybara" src="https://png.pngtree.com/png-clipart/20240709/original/pngtree-cartoon-capybara-with-blue-suit-vector-png-image_15523170.png" alt="–ö–∞–ø–∏–±–∞—Ä–∞">
<div id="board"></div>
<h2 id="message"></h2>

<script>
const boardEl = document.getElementById('board');
const messageEl = document.getElementById('message');

let board = [];
let selectedCell = null;

// –°–æ–∑–¥–∞–µ–º –¥–æ—Å–∫—É
function initBoard(){
  boardEl.innerHTML='';
  board = [];
  for(let r=0;r<8;r++){
    const row=[];
    for(let c=0;c<8;c++){
      const cell = document.createElement('div');
      cell.className = 'cell '+((r+c)%2?"black":"white");
      cell.dataset.r=r;
      cell.dataset.c=c;
      cell.addEventListener('click',()=>cellClick(r,c));
      boardEl.appendChild(cell);

      // —Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ–º —à–∞—à–∫–∏
      if((r+c)%2){
        if(r<3) row.push("bot");
        else if(r>4) row.push("player");
        else row.push(null);
      } else row.push(null);
    }
    board.push(row);
  }
  updateBoard();
}

function updateBoard(){
  for(let r=0;r<8;r++){
    for(let c=0;c<8;c++){
      const cell = boardEl.children[r*8+c];
      cell.innerHTML='';
      if(board[r][c]){
        const p = document.createElement('div');
        p.className='piece '+board[r][c];
        cell.appendChild(p);
      }
    }
  }
}

function cellClick(r,c){
  if(selectedCell){
    const [sr,sc]=selectedCell;
    const piece = board[sr][sc];
    if(!board[r][c] && (r+c)%2===1 && piece==="player"){
      const dr = r-sr;
      const dc = c-sc;

      // –æ–±—ã—á–Ω—ã–π —Ö–æ–¥
      if(Math.abs(dr)===1 && Math.abs(dc)===1){
        board[r][c]=piece;
        board[sr][sc]=null;
        selectedCell=null;
        updateBoard();
        setTimeout(botMove,500);
        return;
      }

      // –ø—Ä—ã–∂–æ–∫ —á–µ—Ä–µ–∑ —à–∞—à–∫—É
      if(Math.abs(dr)===2 && Math.abs(dc)===2){
        const jumpedR = sr + dr/2;
        const jumpedC = sc + dc/2;
        if(board[jumpedR][jumpedC]==="bot"){
          board[jumpedR][jumpedC]=null; // —Å—ä–µ–¥–µ–Ω–Ω–∞—è —à–∞—à–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç
          board[r][c]=piece;
          board[sr][sc]=null;
          selectedCell=null;
          updateBoard();
          setTimeout(botMove,500);
          return;
        }
      }
    }
    selectedCell=null;
  } else {
    if(board[r][c]==="player") selectedCell=[r,c];
  }
}

// –•–æ–¥ –±–æ—Ç–∞ (–æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π)
function botMove(){
  for(let r=0;r<8;r++){
    for(let c=0;c<8;c++){
      if(board[r][c]==="bot"){
        const dirs=[[1,-1],[1,1]]; // –≤–ø–µ—Ä–µ–¥
        for(let [dr,dc] of dirs){
          let nr=r+dr, nc=c+dc;
          if(nr>=0 && nr<8 && nc>=0 && nc<8){
            if(!board[nr][nc]){
              board[nr][nc]="bot";
              board[r][c]=null;
              updateBoard();
              checkWin();
              return;
            } else if(board[nr][nc]==="player"){
              // –ø—Ä—ã–∂–æ–∫ —á–µ—Ä–µ–∑ –∏–≥—Ä–æ–∫–∞
              let jr = nr+dr, jc = nc+dc;
              if(jr>=0 && jr<8 && jc>=0 && jc<8 && !board[jr][jc]){
                board[nr][nc]=null; // —Å—ä–µ–¥–∞–µ–º
                board[jr][jc]="bot";
                board[r][c]=null;
                updateBoard();
                checkWin();
                return;
              }
            }
          }
        }
      }
    }
  }
}

function checkWin(){
  const playerLeft = board.flat().filter(x=>"player"===x).length;
  const botLeft = board.flat().filter(x=>"bot"===x).length;
  if(playerLeft===0){
    messageEl.innerText="–ë–æ—Ç –ø–æ–±–µ–¥–∏–ª! üò¢";
  } else if(botLeft===0){
    messageEl.innerText="–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã –ø–æ–±–µ–¥–∏–ª! üéâ";
  }
}

initBoard();
</script>
</body>
</html>
